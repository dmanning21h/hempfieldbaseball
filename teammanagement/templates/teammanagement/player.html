{% extends 'base.html' %}
{% load static %}
{% load teammanagement_tags %}
{% load playerprogress_tags %}

{% block title %}{{ player.info.full_name }}{% endblock %}
{% block description %}<meta name="description" content="{{ player.info.full_name }} extended roster details and player progress.">{% endblock %}

{% block stylesheet %}
	<link rel="stylesheet" href="{% static 'css/teammanagement.css' %}">
{% endblock %}

{% block content %}

	<div class="container pt-2">
		<hr>
	</div>

	{% show_player_header %}
	<br>

	{% if has_data %}
		<div class="text-center text-dark">
			<h3 class="text-muted">Player Progress</h3>
		</div>

		<div id="accordion" class="container">
			{% show_player_misc %}
			{% show_player_lifts %}
			{% show_player_velocities %}
			{% show_player_times %}
		</div>
	{% endif %}

{% endblock %}



{% block javascript %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script src="{% static 'js/teammanagement.js' %}"></script>

<script>
	generateChart("bodyweight", "Body Weight", "weight", "Weight (lbs)")
	
	{% for lift_name in lift_data %}
		generateChart("{{ lift_name|id_format }}", "{{lift_name}}", "lift", "Strength Points");
	{% endfor %}

	{% for velocity_name in velocity_data %}
		generateChart("{{ velocity_name|id_format }}", "{{ velocity_name }}", "velocity", "Velocity (MPH)");
	{% endfor %}

	

	async function getDataAndDates(metricName, dataType)
	{
		let result;

		try {
			result = await $.ajax({
				url: "{% url 'playerprogress:get-player-data-and-dates' %}",
				type: 'GET',
				data: {
					'data_type': dataType,
					'player_id': "{{ player.info.player_id }}",
					'metric_name': metricName
				},
				dataType: 'json',
			});

			return result;
		} catch (error) {
			console.error(error);
		}
	}
</script>
{% endblock %}